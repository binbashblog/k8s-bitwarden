# k8s bitwarden deployment

Uses the official bitwarden docker images instead of the 3rd party rust implementation

##Requirements
*Docker 18.06.2-ce
*Kubernetes v1.12.5

I first install the official docker image (https://bitwarden.com/help/article/install-on-premise/) on a machine running centos 7 to get the bwdata directory file structure and the configs the bitwarden python script generates which I then copy to a nfs server. 

Alternatively you can follow the manual install procedure to grab the data (the stub zip file) that way: https://bitwarden.com/help/article/install-on-premise-manual/

I copy the contents of the env files to the configmap.yaml file in yaml format and define that configmap in every container so they get the env variables at runtime. You will also need the identity.pfx and the encrypted password and ssh keys generated by the bitwarden script, hence why it's better to set up bitwarden using the official docker script and then just take the bwdata directory and copy it where you want it.
